(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{CSkI:function(e,t,i){"use strict";var n=i("TXxy");i.n(n).a},EyXw:function(e,t,i){e.exports=i("oxns")("EyXw")},N5O7:function(e,t,i){},OHXF:function(e,t,i){e.exports=i("oxns")("OHXF")},QAEY:function(e,t,i){"use strict";var n=i("ZQ4m");i.n(n).a},SXZH:function(e,t,i){"use strict";var n=i("dz0Y");i.n(n).a},TXxy:function(e,t,i){},XIwP:function(e,t,i){"use strict";var n=i("bSzx");i.n(n).a},ZQ4m:function(e,t,i){},bSzx:function(e,t,i){},dz0Y:function(e,t,i){},gZlp:function(e,t,i){},"s+wS":function(e,t,i){"use strict";var n=i("N5O7");i.n(n).a},sIh7:function(e,t,i){"use strict";i.r(t);i("2B1R"),i("zKZe");var n=i("vxXW"),a=i("d9Jj"),s=(i("qePV"),i("8afP")),c=i("YiBa"),r=i("G7ty"),l={name:"review-cell",props:{alias:String,kdtId:Number,count:{type:Number,default:0}},computed:{cellValue:function(){return this.count>0?"查看全部":"暂无评价"},cellTitle:function(){return"商品评价"+(this.count>0?" ("+this.count+")":"")},showLink:function(){return this.count>0}},methods:{showEvaluationList:function(){if(Object(r.b)({et:"click",ei:"customer_reviews",en:"点击评价"}),0!==this.count){var e=this.alias,t=this.kdtId;n.ZNB.navigate({url:Object(c.b)(e,t,{showSummaryTag:!0})})}}}},o=(i("SXZH"),i("KHd+")),u=Object(o.default)(l,(function(){var e=this.$createElement;return(this._self._c||e)("van-cell",{staticClass:"goods-review-cell",attrs:{"is-link":this.showLink,title:this.cellTitle,value:this.cellValue,border:!1,"title-class":"goods-review-cell__title","value-class":"goods-review-cell__value"},on:{click:this.showEvaluationList}})}),[],!1,null,null,null).exports,d=(i("fbCW"),i("oVuX"),i("jZ0v")),f=(i("RmI7"),i("KKL4")),m={name:"review-item-content",props:{content:String,skuDesc:String,images:Array},computed:{formatedImages:function(){return this.images.map((function(e){return Object(s.h)(e,"!300x0.jpg")}))}},methods:{previewImage:function(e){var t=e.target.dataset.index;t&&Object(f.default)({images:this.images.map((function(e){return Object(s.h)(e,"!730x0.jpg")})),startPosition:+t})}}},h=(i("QAEY"),Object(o.default)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.content||e.formatedImages.length?i("div",{staticClass:"review-content"},[e.content?i("p",{staticClass:"van-multi-ellipsis--l2",domProps:{textContent:e._s(e.content)}}):e._e(),e.formatedImages.length?i("div",{staticClass:"review-images",on:{click:function(t){t.stopPropagation(),e.previewImage(t)}}},e._l(e.formatedImages,(function(e,t){return i("div",{key:t,staticClass:"image-item",attrs:{"data-index":t}},[i("div",{staticClass:"image-item__block"},[i("img",{attrs:{src:e}})])])})),0):e._e(),e.skuDesc?i("div",{staticClass:"sku-desc",domProps:{textContent:e._s(e.skuDesc)}}):e._e()]):e._e()}),[],!1,null,"fd67f0a8",null).exports),g=(i("aO+S"),i("nXDD"),i("N0PS"),i("gZlp"),i("oUJm")),v=i("EyXw"),p=i("OHXF"),b=i("eOum"),w=i("rQYt"),_=Object(g.createNamespace)("rate"),y=_[0],S=_[1];var I,k,C=y({mixins:[p.TouchMixin,b.FieldMixin],props:{size:[Number,String],color:String,gutter:[Number,String],readonly:Boolean,disabled:Boolean,allowHalf:Boolean,voidColor:String,iconPrefix:String,disabledColor:String,value:{type:Number,default:0},icon:{type:String,default:"star"},voidIcon:{type:String,default:"star-o"},count:{type:[Number,String],default:5},touchable:{type:Boolean,default:!0}},computed:{list:function(){for(var e,t,i,n=[],a=1;a<=this.count;a++)n.push((e=this.value,t=a,i=this.allowHalf,e>=t?"full":e+.5>=t&&i?"half":"void"));return n},sizeWithUnit:function(){return Object(g.addUnit)(this.size)},gutterWithUnit:function(){return Object(g.addUnit)(this.gutter)}},mounted:function(){this.bindTouchEvent(this.$el)},methods:{select:function(e){this.disabled||this.readonly||e===this.value||(this.$emit("input",e),this.$emit("change",e))},onTouchStart:function(e){var t=this;if(!this.readonly&&!this.disabled&&this.touchable){this.touchStart(e);var i=this.$refs.items.map((function(e){return e.getBoundingClientRect()})),n=[];i.forEach((function(e,i){t.allowHalf?n.push({score:i+.5,left:e.left},{score:i+1,left:e.left+e.width/2}):n.push({score:i+1,left:e.left})})),this.ranges=n}},onTouchMove:function(e){if(!this.readonly&&!this.disabled&&this.touchable&&(this.touchMove(e),"horizontal"===this.direction)){Object(v.preventDefault)(e);var t=e.touches[0].clientX;this.select(this.getScoreByPosition(t))}},getScoreByPosition:function(e){for(var t=this.ranges.length-1;t>0;t--)if(e>this.ranges[t].left)return this.ranges[t].score;return this.allowHalf?.5:1},genStar:function(e,t){var i,n=this,a=this.$createElement,s=this.icon,c=this.color,r=this.count,l=this.voidIcon,o=this.disabled,u=this.voidColor,d=this.disabledColor,f=t+1,m="full"===e,h="void"===e;return this.gutterWithUnit&&f!==+r&&(i={paddingRight:this.gutterWithUnit}),a("div",{ref:"items",refInFor:!0,key:t,attrs:{role:"radio",tabindex:"0","aria-setsize":r,"aria-posinset":f,"aria-checked":String(!h)},style:i,class:S("item")},[a(w.default,{attrs:{size:this.sizeWithUnit,name:m?s:l,color:o?d:m?c:u,classPrefix:this.iconPrefix,"data-score":f},class:S("icon",{disabled:o,full:m}),on:{click:function(){n.select(f)}}}),this.allowHalf&&a(w.default,{attrs:{size:this.sizeWithUnit,name:h?l:s,color:o?d:h?u:c,classPrefix:this.iconPrefix,"data-score":f-.5},class:S("icon",["half",{disabled:o,full:!h}]),on:{click:function(){n.select(f-.5)}}})])}},render:function(){var e=this,t=arguments[0];return t("div",{class:S({readonly:this.readonly,disabled:this.disabled}),attrs:{tabindex:"0",role:"radiogroup"}},[this.list.map((function(t,i){return e.genStar(t,i)}))])}}),P={VIP1:"https://img.yzcdn.cn/public_files/28160609bfef95c54e617ba254805975.png",VIP2:"https://img.yzcdn.cn/public_files/83274d4e198daa2e17049703e56fd03c.png",VIP3:"https://img.yzcdn.cn/public_files/5b6e4b4dbfc9ff30c6994951da9f0435.png",VIP4:"https://img.yzcdn.cn/public_files/f3e60b940277a9177a0a230f20555f78.png",VIP5:"https://img.yzcdn.cn/public_files/7f30ec5a559890c394db1db24bfe9a38.png",VIP6:"https://img.yzcdn.cn/public_files/49e1d6c34148a36400b6ee5516793d75.png",VIP7:"https://img.yzcdn.cn/public_files/1b62ebad97ce1ce12c13de8635e9ea43.png",VIP8:"https://img.yzcdn.cn/public_files/bd99456a858f720c9326ba202e0e56a6.png",VIP9:"https://img.yzcdn.cn/public_files/2be595923cefa6aafda3875927fd0402.png",VIP10:"https://img.yzcdn.cn/public_files/94f81fb3d2aaec56fa364ba2037dc319.png",SVIP1:"https://img.yzcdn.cn/public_files/fe2fe3dd0abc536a05eea213f76d81ae.png",SVIP2:"https://img.yzcdn.cn/public_files/312c920eb93f31806548100ae3cbc836.png",SVIP3:"https://img.yzcdn.cn/public_files/52d4aeb215fc6ad0454a6db8c33006d9.png",SVIP4:"https://img.yzcdn.cn/public_files/88c955e32c5aab95b4ce72440697d467.png",SVIP5:"https://img.yzcdn.cn/public_files/3a4c0d6129c61e0902c6c1cb4849cef7.png",SVIP6:"https://img.yzcdn.cn/public_files/cd87c39a085fbd035dc118db1ee115dc.png",SVIP7:"https://img.yzcdn.cn/public_files/fd63d3dba70c80d6fff976d79f79c092.png",SVIP8:"https://img.yzcdn.cn/public_files/df1e101d9c6a8389e7eee34c5f97deb3.png",SVIP9:"https://img.yzcdn.cn/public_files/f8e2abc915198b0dc6c495f42a51a08f.png",SVIP10:"https://img.yzcdn.cn/public_files/173dde794c398fd0e1c670bcc5244645.png"},z={name:"review-item-header",state:{evaluationMemberLabel:function(e){return e.shopConfig.evaluationMemberLabel}},components:(I={},I[C.name]=C,I),props:{rate:Number,avatar:String,nickname:String,isBuyAgain:Number,member:Object},computed:{score:function(){return this.rate/20},memberLevel:function(){return 0==+this.evaluationMemberLabel&&this.member?P[this.member.level]:""},memberName:function(){return 1==+this.evaluationMemberLabel&&this.member&&this.member.levelName||""}}},x=(i("CSkI"),Object(o.default)(z,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"review-item-user"},[i("img",{staticClass:"review-item-user__img",attrs:{src:e.avatar}}),i("div",{staticClass:"review-item-user-message__block"},[i("div",{staticClass:"review-item-user-name",domProps:{textContent:e._s(e.nickname)}}),i("div",{staticClass:"review-item-user-flag__block"},[e.memberLevel?i("img",{staticClass:"review-item-user__member-level",attrs:{src:e.memberLevel}}):e._e(),e.memberName?i("div",{staticClass:"review-item-user__member-name"},[e._v("\n        "+e._s(e.memberName)+"\n      ")]):e._e(),e.isBuyAgain?i("div",{staticClass:"review-item-user-buy-flag"},[e._v("\n        买了又买\n      ")]):e._e()])]),i("div",{staticClass:"review-item-user__rate"},[i("van-rate",{attrs:{count:5,size:10,color:"#FF4444","void-icon":"star","void-color":"#DCDEE0",readonly:""},model:{value:e.score,callback:function(t){e.score=t},expression:"score"}})],1)])}),[],!1,null,"38588b1c",null).exports),O=[{name:"正品",class:"review-detail-tag--zp"}],j={name:"review-detail",components:(k={},k[d.a.name]=d.a,k.ItemContent=h,k.ItemHeader=x,k),props:{list:Array,tags:Array,alias:String,kdtId:Number},methods:{showEvaluationList:function(e){var t=this.alias,i=this.kdtId,a={showSummaryTag:!0};e&&e.code&&(a.tagCode=e.code),n.ZNB.navigate({url:Object(c.b)(t,i,a)})},computedTagBgStyle:function(e){var t=O.find((function(t){return t.name===e.name}));return t?t.class+"-bg":"theme__background"},computedTagStyle:function(e){var t=["review-detail-tag__main"],i=O.find((function(t){return t.name===e.name}));return i&&t.push(i.class),t.join(" ")}}},V=(i("XIwP"),{name:"GoodsReviewBlock",state:{showCustomerReviews:function(e){return!!e.shopConfig.showCustomerReviews},alias:function(e){return e.goods.alias},kdtId:function(e){return e.shop.kdtId}},components:{ReviewCell:u,ReviewDetail:Object(o.default)(j,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("van-cell-group",[e.tags.length>0?i("van-cell",{staticClass:"review-tags"},e._l(e.tags,(function(t){return i("common-tag",{key:t.id,staticClass:"review-detail-tag",attrs:{"container-style":e.computedTagBgStyle(t),"tag-style":e.computedTagStyle(t)},nativeOn:{click:function(i){e.showEvaluationList(t)}}},[i("span",{staticClass:"review-detail-tag__tag"},[e._v(e._s(t.name))])])})),1):e._e(),e._l(e.list,(function(t){return i("van-cell",{key:t.id,on:{click:e.showEvaluationList}},[i("item-header",{attrs:{rate:t.score,avatar:t.reviewerAvatar,"is-buy-again":t.userReBuyModel,member:t.userLevelModel,nickname:t.reviewerNickName}}),i("item-content",{attrs:{content:t.content,"sku-desc":t.specification,images:t.picturesList}})],1)}))],2)}),[],!1,null,null,null).exports},data:function(){return{review:{count:0,tags:[],reviews:[]}}},created:function(){n.ZNB.init({kdtId:this.kdtId}),this.showCustomerReviews&&this.fetchReviewDetail(this.alias)},methods:{formatSummaryTags:function(e){var t=e.tagSummaryModels||[];return{count:e.evaluationTotalCount||0,tags:t.map((function(e){return{name:e.tagName,code:e.tagCode,count:e.count}}))}},formatReviewData:function(e){var t=e.evaluationModels||[];return t.length>0?[Object.assign({},e,t[0])]:[]},fetchReviewDetail:function(e){var t=this;a.a.get({url:"/wscgoods/detail-api/review-info-fast.json",data:{alias:e,allowSummaryTag:!0},options:{useCdn:!0}}).then((function(e){var i=e||{},n=i.reviewInfo,a=void 0===n?{}:n,s=i.itemSummary,c=void 0===s?{}:s,r=t.formatSummaryTags(c);t.review=Object.assign({},r,{reviews:t.formatReviewData(a)})}))}}}),N=(i("s+wS"),Object(o.default)(V,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.showCustomerReviews?i("div",{staticClass:"m-goods-review",attrs:{id:"js-nav-review"}},[i("review-cell",{attrs:{count:e.review.count,alias:e.alias,"kdt-id":e.kdtId}}),e.review.reviews.length>0?i("review-detail",{attrs:{list:e.review.reviews,tags:e.review.tags,alias:e.alias,"kdt-id":e.kdtId}}):e._e()],1):e._e()}),[],!1,null,null,null));t.default=N.exports}}]);